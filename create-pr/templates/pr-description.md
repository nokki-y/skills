# PR説明テンプレート

以下のフォーマットでPR説明を生成する。

```markdown
## Summary

<!-- 変更の目的と概要を1〜3行で記載 -->
<!-- 関連するIssue番号があればリンクする（例: Closes #123） -->

## レビューガイド

### 推奨レビュー順序

<!-- レビュー順序の方針とその理由を1〜2行で説明する -->
<!-- 例: 変更は**下流から上流**（型定義 → コンバーター → API → UI）の順でレビューすることを推奨します。 -->
<!-- 例: この順序により、型の一貫性を追跡しやすくなります。 -->

---

### Step 1: <レイヤー/カテゴリ名>のレビュー（<補足説明>）

**対象ファイル:**

1. `path/to/file1.ts`
2. `path/to/file2.ts`（新規）
3. `path/to/file3.ts`

**レビュー観点:**

- [ ] <具体的な確認項目1>
- [ ] <具体的な確認項目2>
- [ ] <具体的な確認項目3>

---

### Step 2: <レイヤー/カテゴリ名>のレビュー

**対象ファイル:**

1. `path/to/file4.ts`（新規）
2. `path/to/file5.ts`

**レビュー観点:**

- [ ] <具体的な確認項目1>
- [ ] <具体的な確認項目2>

<!-- 特に注意が必要なコードがあればスニペットを含める -->

  ```typescript
  // 重要: このロジックが正しいことを確認
  function example(): boolean {
    return someCondition;
  }
  ```

---

<!-- Step 3, 4, ... と変更の規模に応じてステップを追加 -->

## Test plan

- [ ] <テスト項目1>
- [ ] <テスト項目2>
```

## テンプレート記載ルール

### Summary

- 「何を」「なぜ」変更したかを簡潔に書く
- 関連するIssue番号があればリンクする（例: Closes #123）

### 推奨レビュー順序

- 冒頭でレビュー順序の**方針**と**その理由**を必ず説明する
- 変更内容に応じた最適な順序を選択する。以下は一般的なパターン例:
  - **下流から上流**: 型定義 → ロジック → API → UI（型の一貫性を追跡しやすい）
  - **上流から下流**: エントリーポイント → 内部ロジック → ユーティリティ（データフローを追いやすい）
  - **重要度順**: コアロジック → 周辺コード → テスト（最も重要な変更を先にレビュー）
- 変更に最適な順序を判断し、機械的にデフォルト順序を適用しない

### Step の構成

- **Step名**: レイヤーやカテゴリの名称 + 補足説明をつける
  - 例: `Step 1: 型定義・スキーマのレビュー（ドメイン層）`
  - 例: `Step 2: コンバーター層のレビュー`
  - 例: `Step 3: API層のレビュー（tRPC/サービス）`
- **対象ファイル**: 番号付きリストで列挙する
  - 新規ファイルには `（新規）` を付記する
  - ファイルの並び順はそのStep内でのレビュー推奨順
- **レビュー観点**: チェックリスト形式（`- [ ]`）で具体的に記載する
  - 抽象的な観点（「正しいか確認」）ではなく、**差分の内容に基づいた具体的な確認項目**を書く
  - 例: `QuestionTypeEnum に AGREEMENT が正しく追加されているか`
  - 例: `is_grid_layout 関連の変換ロジックが完全に削除されているか`
  - 例: `NULL/undefinedのハンドリングが適切か`
- **コードスニペット**: 特に注意が必要なロジックがあればコードブロックで示す
  - ロジックの正しさを確認すべき箇所
  - 破壊的変更や後方互換性に関わる箇所

### Step のグルーピング基準

- 同じアーキテクチャ層・同じ関心事のファイルを1つのStepにまとめる
- Step数は変更の規模に応じて柔軟に調整する（2〜6程度が目安）
- 1ファイルだけの変更でも、重要度が高ければ独立したStepにする

### レビュー観点の記載ガイド

各ファイルの差分を読み、以下のような観点でチェック項目を作成する：

- **追加されたもの**: 新しい型、フィールド、関数が正しく定義されているか
- **削除されたもの**: 参照が完全に取り除かれているか、残存していないか
- **変更されたもの**: 変更前後の整合性、既存機能への影響
- **エッジケース**: NULL/undefined処理、境界値、エラーハンドリング
- **セキュリティ**: 入力バリデーション、認証/認可
- **パフォーマンス**: N+1クエリ、不要な再レンダリング
- **冪等性**: DBマイグレーション、スクリプトの安全性

変更量が多いファイルほど観点を詳しく書き、軽微な変更（リネーム、フォーマット修正等）はその旨を明記してレビュー負荷を下げる。

### Test plan

- 手動テスト、自動テストの両方を含める
- 具体的な確認手順を書く
